import cv2
import numpy as np

def detect_pink_boxes_with_template(image_path, output_path, template_path):
    
    image = cv2.imread(image_path)
    template = cv2.imread(template_path)

    
    gray_image = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
    gray_template = cv2.cvtColor(template, cv2.COLOR_BGR2GRAY)

    
    result = cv2.matchTemplate(gray_image, gray_template, cv2.TM_CCOEFF_NORMED)

    
    threshold = 0.8  # Adjust this threshold if necessary
    locations = np.where(result >= threshold)

    
    w, h = gray_template.shape[::-1]  
    for pt in zip(*locations[::-1]):
        cv2.rectangle(image, pt, (pt[0] + w, pt[1] + h), (0, 255, 0), 3)

    
    cv2.imwrite(output_path, image)
    print(f"Processed image saved to {output_path}")


detect_pink_boxes_with_template(
    "omr_aiml_dataset_page_10.png", #image_path
    "final_output_template_matching.jpg", 
    "pink_temp.png"  # Path to your template pink box image
)
